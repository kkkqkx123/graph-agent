# 数据处理脚本配置
name = "data-processor"
script_type = "PYTHON"
description = "A Python script for processing data with error handling"
enabled = true

# 脚本内容（内联代码）
content = """
#!/usr/bin/env python3
import json
import sys
import os
from datetime import datetime

def process_data(input_data):
    \"\"\"处理输入数据\"\"\"
    try:
        # 模拟数据处理
        processed = {
            'original': input_data,
            'processed_at': datetime.now().isoformat(),
            'processed_by': os.getenv('SCRIPT_NAME', 'unknown'),
            'status': 'success'
        }
        return processed
    except Exception as e:
        return {
            'error': str(e),
            'status': 'failed'
        }

if __name__ == "__main__":
    # 从环境变量获取输入数据，或使用默认值
    input_data = os.getenv('INPUT_DATA', '{"message": "default data"}')
    
    try:
        # 解析输入数据
        data = json.loads(input_data)
        result = process_data(data)
        
        # 输出结果
        print(json.dumps(result, indent=2))
        sys.exit(0)
    except Exception as e:
        print(json.dumps({'error': str(e), 'status': 'failed'}, indent=2))
        sys.exit(1)
"""

# 执行选项
[options]
timeout = 60000
retries = 3
retryDelay = 2000
workingDirectory = "/tmp"
sandbox = true

# 沙箱配置
[options.sandboxConfig]
type = "docker"
image = "python:3.9-slim"
resourceLimits = { memory = 512, cpu = 1, disk = 100 }
network = { enabled = false }

# 环境变量
[options.environment]
SCRIPT_NAME = "data-processor"
SCRIPT_VERSION = "1.0.0"
INPUT_DATA = '{"message": "Hello from Python script"}'

# 元数据
[metadata]
category = "data-processing"
tags = ["python", "data", "processing", "json"]
author = "Data Team"
version = "1.0.0"
documentationUrl = "https://example.com/docs/data-processor"