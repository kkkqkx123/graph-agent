# Domainå±‚Repositorieså®ç°é—®é¢˜åˆ†æä¸ä¼˜åŒ–å»ºè®®

> **ä¼˜åŒ–åŸåˆ™**ï¼šé¿å…åˆ›å»ºæ–°æ–‡ä»¶ï¼Œåœ¨ç°æœ‰ä»£ç åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ã€‚æœ¬æ–‡æ¡£ä¸æä¾›å…·ä½“ä»£ç å®ç°ï¼Œä»…ç»™å‡ºä¼˜åŒ–æ–¹å‘ã€‚
>
> **å·²å®Œæˆçš„ä¼˜åŒ–**ï¼š
> - åœ¨ [`BaseRepository`](src/infrastructure/persistence/base/base-repository.ts:1) ä¸­æ·»åŠ äº†å…¬å…±æŸ¥è¯¢é€»è¾‘è¾…åŠ©æ–¹æ³•
> - åœ¨ [`type-converter-base.ts`](src/infrastructure/persistence/base/type-converter-base.ts:1) ä¸­æ·»åŠ äº†è½¬æ¢å™¨å·¥å‚

## ä¸€ã€æ ¸å¿ƒç»“è®º

**Domainå±‚Repositoriesä¸æ˜¯å¤šä½™çš„ï¼Œè€Œæ˜¯æ¶æ„è®¾è®¡çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ã€‚**

ä¿ç•™Domainå±‚Repositoriesçš„ç†ç”±ï¼š
- å®ç°ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰ï¼ŒApplicationå±‚ä¾èµ–æ¥å£è€Œéå®ç°
- ä½¿ç”¨ä¸šåŠ¡è¯­è¨€å®šä¹‰å¥‘çº¦ï¼Œè€ŒéæŠ€æœ¯æœ¯è¯­
- æä¾›ç±»å‹å®‰å…¨ä¿éšœï¼Œç¡®ä¿Applicationå±‚ä½¿ç”¨Domainå®ä½“
- æ”¯æŒè½»æ¾mockï¼Œæé«˜å¯æµ‹è¯•æ€§
- ä¾¿äºåˆ‡æ¢å­˜å‚¨å®ç°ï¼ˆå¦‚ä»SQLåˆ‡æ¢åˆ°NoSQLï¼‰

## äºŒã€å½“å‰å®ç°å­˜åœ¨çš„ä¸»è¦é—®é¢˜

### 2.1 Domainå±‚æ¥å£è®¾è®¡é—®é¢˜

#### é—®é¢˜1ï¼šæ¥å£æ–¹æ³•è¿‡å¤šä¸”å­˜åœ¨é‡å¤

**è¡¨ç°**ï¼š
- WorkflowRepositoryæœ‰20+æ–¹æ³•
- å­˜åœ¨åŠŸèƒ½é‡å¤çš„æ–¹æ³•ï¼Œå¦‚`findActiveWorkflows()`å’Œ`findByStatus(WorkflowStatus.active())`

**å½±å“**ï¼š
- æ¥å£è‡ƒè‚¿ï¼Œéš¾ä»¥ç»´æŠ¤
- å¢åŠ å®ç°æˆæœ¬
- è¿åDRYåŸåˆ™

#### é—®é¢˜2ï¼šè¿”å›ç±»å‹ä¸å¤Ÿæ˜ç¡®

**è¡¨ç°**ï¼š
- éƒ¨åˆ†æ–¹æ³•è¿”å›`any`ç±»å‹ï¼Œå¦‚`getThreadExecutionStats()`

**å½±å“**ï¼š
- ç±»å‹å®‰å…¨æ€§å·®
- IDEæ— æ³•æä¾›æ™ºèƒ½æç¤º
- å®¹æ˜“å‡ºç°è¿è¡Œæ—¶é”™è¯¯

#### é—®é¢˜3ï¼šç¼ºä¹æŸ¥è¯¢å¯¹è±¡æ¨¡å¼

**è¡¨ç°**ï¼š
- æ¯ä¸ªæŸ¥è¯¢æ¡ä»¶éƒ½æ˜¯ç‹¬ç«‹æ–¹æ³•
- ç¼ºä¹çµæ´»çš„ç»„åˆæŸ¥è¯¢èƒ½åŠ›

**å½±å“**ï¼š
- æ¥å£æ–¹æ³•æ•°é‡çˆ†ç‚¸
- éš¾ä»¥æ”¯æŒå¤æ‚æŸ¥è¯¢ç»„åˆ

### 2.2 Infrastructureå±‚å®ç°é—®é¢˜

#### é—®é¢˜1ï¼šä»£ç é‡å¤ä¸¥é‡

**è¡¨ç°**ï¼š
- ThreadRepositoryæ–‡ä»¶è¶…è¿‡900è¡Œ
- å¤§é‡é‡å¤çš„æŸ¥è¯¢æ¡ä»¶æ£€æŸ¥ï¼ˆå¦‚`isDeleted`ã€`sessionId`ã€`workflowId`ï¼‰
- ç›¸ä¼¼çš„æŸ¥è¯¢é€»è¾‘åœ¨å¤šä¸ªæ–¹æ³•ä¸­é‡å¤

**å½±å“**ï¼š
- ç»´æŠ¤å›°éš¾ï¼Œä¿®æ”¹éœ€è¦åŒæ­¥å¤šå¤„
- å®¹æ˜“å‡ºç°ä¸ä¸€è‡´
- ä»£ç å¯è¯»æ€§å·®

#### é—®é¢˜2ï¼šæ–¹æ³•è¿‡é•¿

**è¡¨ç°**ï¼š
- `toEntity()`æ–¹æ³•è¶…è¿‡100è¡Œ
- åŒ…å«å¤æ‚çš„è½¬æ¢é€»è¾‘å’Œå¯¹è±¡åˆ›å»º

**å½±å“**ï¼š
- éš¾ä»¥ç†è§£å’Œç»´æŠ¤
- éš¾ä»¥æµ‹è¯•
- è¿åå•ä¸€èŒè´£åŸåˆ™

#### é—®é¢˜3ï¼šæ··åˆäº†ä¸šåŠ¡æ–¹æ³•å’ŒæŠ€æœ¯æ–¹æ³•

**è¡¨ç°**ï¼š
- åŒæ—¶å®ç°åœ¨Domainæ¥å£ä¸­å®šä¹‰çš„ä¸šåŠ¡æ–¹æ³•
- åŒ…å«ä¸åœ¨Domainæ¥å£ä¸­çš„æŠ€æœ¯æ–¹æ³•ï¼ˆå¦‚`findBySessionId`ã€`findByStatus`ç­‰ï¼‰

**å½±å“**ï¼š
- èŒè´£ä¸æ¸…
- è¿åæ¥å£éš”ç¦»åŸåˆ™
- å¢åŠ ä¸å¿…è¦çš„å…¬å…±API

#### é—®é¢˜4ï¼šå­˜åœ¨æœªä½¿ç”¨çš„æ¥å£æ–¹æ³•

**è¡¨ç°**ï¼š
- å®ç°äº†Domainæ¥å£ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•
- è¿™äº›æ–¹æ³•å¯èƒ½æ˜¯æ—©æœŸè®¾è®¡é—ç•™

**å½±å“**ï¼š
- æ¥å£ä¸ä¸€è‡´
- å¯èƒ½å¯¼è‡´è¯¯ç”¨
- å¢åŠ ç»´æŠ¤è´Ÿæ‹…

### 2.3 ç±»å‹è½¬æ¢å’Œæ˜ å°„é—®é¢˜

#### é—®é¢˜1ï¼šç±»å‹è½¬æ¢å™¨å®šä¹‰é‡å¤

**è¡¨ç°**ï¼š
- æ¯ä¸ªrepositoryéƒ½å®šä¹‰è‡ªå·±çš„converter
- ç›¸ä¼¼çš„è½¬æ¢é€»è¾‘åœ¨å¤šä¸ªæ–‡ä»¶ä¸­é‡å¤

**å½±å“**ï¼š
- ä»£ç é‡å¤
- ç»´æŠ¤æˆæœ¬é«˜
- å®¹æ˜“å‡ºç°ä¸ä¸€è‡´

#### é—®é¢˜2ï¼šè½¬æ¢é€»è¾‘å¤æ‚

**è¡¨ç°**ï¼š
- `toEntity()`æ–¹æ³•ä¸­åŒ…å«å¤æ‚çš„å¯¹è±¡åˆ›å»ºé€»è¾‘
- ExecutionContextçš„åˆ›å»ºé€»è¾‘è¿‡äºå¤æ‚

**å½±å“**ï¼š
- è½¬æ¢é€»è¾‘éš¾ä»¥ç†è§£
- éš¾ä»¥æµ‹è¯•
- å®¹æ˜“å‡ºé”™

### 2.4 æŸ¥è¯¢é€»è¾‘é—®é¢˜

#### é—®é¢˜1ï¼šæŸ¥è¯¢æ¡ä»¶é‡å¤

**è¡¨ç°**ï¼š
- æ¯ä¸ªæ–¹æ³•éƒ½é‡å¤`isDeleted = false`æ£€æŸ¥
- ç›¸åŒçš„è¿‡æ»¤æ¡ä»¶åœ¨å¤šå¤„é‡å¤

**å½±å“**ï¼š
- ä»£ç é‡å¤
- å®¹æ˜“é—æ¼
- ç»´æŠ¤å›°éš¾

#### é—®é¢˜2ï¼šç¼ºä¹æŸ¥è¯¢æ„å»ºå™¨çš„ç»Ÿä¸€ä½¿ç”¨

**è¡¨ç°**ï¼š
- æ··åˆä½¿ç”¨ä¸åŒçš„æŸ¥è¯¢æ–¹å¼ï¼ˆQueryOptionsã€QueryBuilderã€QueryOptionsBuilderï¼‰
- ä»£ç é£æ ¼ä¸ä¸€è‡´

**å½±å“**ï¼š
- éš¾ä»¥ç»´æŠ¤
- å­¦ä¹ æˆæœ¬é«˜
- ä»£ç å¯è¯»æ€§å·®

#### é—®é¢˜3ï¼šSQLæ³¨å…¥é£é™©

**è¡¨ç°**ï¼š
- ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶

**å½±å“**ï¼š
- å®‰å…¨é£é™©
- ç±»å‹ä¸å®‰å…¨

### 2.5 é”™è¯¯å¤„ç†é—®é¢˜

#### é—®é¢˜1ï¼šé”™è¯¯å¤„ç†ä¸ä¸€è‡´

**è¡¨ç°**ï¼š
- æ··åˆä½¿ç”¨ä¸åŒçš„é”™è¯¯å¤„ç†æ–¹å¼
- æœ‰çš„æŠ›å‡ºæ™®é€šErrorï¼Œæœ‰çš„æŠ›å‡ºå¸¦codeçš„Errorï¼Œæœ‰çš„ä½¿ç”¨BaseRepositoryçš„handleError

**å½±å“**ï¼š
- é”™è¯¯å¤„ç†ä¸ç»Ÿä¸€
- éš¾ä»¥æ•è·å’Œå¤„ç†ç‰¹å®šé”™è¯¯
- è°ƒè¯•å›°éš¾

#### é—®é¢˜2ï¼šé”™è¯¯ä¸Šä¸‹æ–‡ä¿¡æ¯ä¸è¶³

**è¡¨ç°**ï¼š
- é”™è¯¯ä¿¡æ¯ç¼ºä¹ä¸Šä¸‹æ–‡ï¼ˆå¦‚modelIdã€operationã€fieldç­‰ï¼‰

**å½±å“**ï¼š
- éš¾ä»¥å®šä½é—®é¢˜
- è°ƒè¯•å›°éš¾

## ä¸‰ã€ä¼˜åŒ–å»ºè®®ï¼ˆä¸åˆ›å»ºæ–°æ–‡ä»¶ï¼‰

### 3.1 Domainå±‚ä¼˜åŒ–

#### å»ºè®®1ï¼šå¼•å…¥æŸ¥è¯¢å¯¹è±¡æ¨¡å¼

**æ–¹å‘**ï¼š
- å®šä¹‰æŸ¥è¯¢å¯¹è±¡æ¥å£ï¼ŒåŒ…å«å¸¸ç”¨çš„æŸ¥è¯¢æ¡ä»¶
- æ·»åŠ é€šç”¨çš„`query()`ã€`queryOne()`ã€`count()`æ–¹æ³•
- ä¿ç•™ä¸šåŠ¡ç‰¹å®šçš„æ–¹æ³•ï¼ˆå¦‚`findActiveThreadsForSession`ï¼‰

**æ•ˆæœ**ï¼š
- å‡å°‘æ¥å£æ–¹æ³•æ•°é‡
- æé«˜æŸ¥è¯¢çµæ´»æ€§
- ç®€åŒ–æ¥å£å®šä¹‰

#### å»ºè®®2ï¼šæ˜ç¡®å®šä¹‰è¿”å›ç±»å‹

**æ–¹å‘**ï¼š
- ä¸ºæ‰€æœ‰æ–¹æ³•å®šä¹‰æ˜ç¡®çš„è¿”å›ç±»å‹
- é¿å…ä½¿ç”¨`any`ç±»å‹
- ä¸ºå¤æ‚è¿”å›å€¼å®šä¹‰ä¸“é—¨çš„ç±»å‹æ¥å£

**æ•ˆæœ**ï¼š
- æé«˜ç±»å‹å®‰å…¨æ€§
- æ”¹å–„IDEæ™ºèƒ½æç¤º
- å‡å°‘è¿è¡Œæ—¶é”™è¯¯

#### å»ºè®®3ï¼šç§»é™¤é‡å¤æ–¹æ³•

**æ–¹å‘**ï¼š
- è¯†åˆ«åŠŸèƒ½é‡å¤çš„æ–¹æ³•
- ä½¿ç”¨é€šç”¨æŸ¥è¯¢æ–¹æ³•æ›¿ä»£
- ä¿ç•™çœŸæ­£ä¸šåŠ¡ç‰¹å®šçš„æ–¹æ³•

**æ•ˆæœ**ï¼š
- ç®€åŒ–æ¥å£
- å‡å°‘å®ç°è´Ÿæ‹…
- æé«˜å¯ç»´æŠ¤æ€§

### 3.2 Infrastructureå±‚ä¼˜åŒ–

#### å»ºè®®1ï¼šæå–å…¬å…±æŸ¥è¯¢é€»è¾‘åˆ°BaseRepository âœ… å·²å®Œæˆ

**å·²å®ç°**ï¼š
- åœ¨ [`BaseRepository`](src/infrastructure/persistence/base/base-repository.ts:1040) ä¸­æ·»åŠ äº†ä»¥ä¸‹è¾…åŠ©æ–¹æ³•ï¼š
  - `applySoftDeleteFilter()` - åº”ç”¨è½¯åˆ é™¤è¿‡æ»¤æ¡ä»¶
  - `applyFieldFilter()` - åº”ç”¨å­—æ®µè¿‡æ»¤æ¡ä»¶
  - `applyTimeRangeFilter()` - åº”ç”¨æ—¶é—´èŒƒå›´è¿‡æ»¤æ¡ä»¶
  - `applyStatusFilter()` - åº”ç”¨çŠ¶æ€è¿‡æ»¤æ¡ä»¶

**ä½¿ç”¨æ–¹å¼**ï¼š
å­ç±»å¯ä»¥åœ¨ `customConditions` ä¸­è°ƒç”¨è¿™äº›æ–¹æ³•ï¼Œé¿å…é‡å¤ä»£ç ã€‚

**æ•ˆæœ**ï¼š
- å‡å°‘ä»£ç é‡å¤
- ç»Ÿä¸€æŸ¥è¯¢é€»è¾‘
- æé«˜ä»£ç å¤ç”¨æ€§

#### å»ºè®®2ï¼šæ‹†åˆ†é•¿æ–¹æ³•

**æ–¹å‘**ï¼š
- å°†`toEntity()`æ–¹æ³•æ‹†åˆ†ä¸ºå¤šä¸ªç§æœ‰è¾…åŠ©æ–¹æ³•
- æ¯ä¸ªæ–¹æ³•è´Ÿè´£ä¸€ä¸ªæ˜ç¡®çš„è½¬æ¢ä»»åŠ¡
- æé«˜ä»£ç å¯è¯»æ€§å’Œå¯æµ‹è¯•æ€§

**æ•ˆæœ**ï¼š
- æé«˜å¯ç»´æŠ¤æ€§
- ä¾¿äºå•å…ƒæµ‹è¯•
- æ”¹å–„ä»£ç å¯è¯»æ€§

#### å»ºè®®3ï¼šç§»é™¤æœªä½¿ç”¨çš„æ¥å£æ–¹æ³•

**æ–¹å‘**ï¼š
- æ¸…ç†ä¸åœ¨Domainæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•
- æˆ–è€…å°†è¿™äº›æ–¹æ³•æ ‡è®°ä¸ºç§æœ‰
- ç¡®ä¿å…¬å…±APIä¸Domainæ¥å£ä¸€è‡´

**æ•ˆæœ**ï¼š
- æ¥å£ä¸€è‡´æ€§
- å‡å°‘è¯¯ç”¨é£é™©
- é™ä½ç»´æŠ¤è´Ÿæ‹…

### 3.3 ç±»å‹è½¬æ¢ä¼˜åŒ–

#### å»ºè®®1ï¼šåœ¨type-converter-base.tsä¸­æ·»åŠ é€šç”¨è½¬æ¢å™¨å·¥å‚ âœ… å·²å®Œæˆ

**å·²å®ç°**ï¼š
- åœ¨ [`type-converter-base.ts`](src/infrastructure/persistence/base/type-converter-base.ts:142) ä¸­æ·»åŠ äº† `ValueObjectConverterFactory` ç±»
- æä¾›äº†ä¸¤ä¸ªå·¥å‚æ–¹æ³•ï¼š
  - `createForEnum()` - åˆ›å»ºå­—ç¬¦ä¸²æšä¸¾ç±»å‹çš„è½¬æ¢å™¨
  - `createForNumberEnum()` - åˆ›å»ºæ•°å­—æšä¸¾ç±»å‹çš„è½¬æ¢å™¨

**ä½¿ç”¨æ–¹å¼**ï¼š
```typescript
const ThreadStatusConverter = ValueObjectConverterFactory.createForEnum(
  ['pending', 'running', 'paused', 'completed', 'failed', 'cancelled'],
  ThreadStatus.fromString,
  (value: ThreadStatus) => value.getValue()
);
```

**æ•ˆæœ**ï¼š
- å‡å°‘ä»£ç é‡å¤
- ç»Ÿä¸€è½¬æ¢é€»è¾‘
- é™ä½ç»´æŠ¤æˆæœ¬

#### å»ºè®®2ï¼šæå–å¤æ‚è½¬æ¢é€»è¾‘åˆ°è¾…åŠ©æ–¹æ³•

**æ–¹å‘**ï¼š
- åœ¨repositoryå†…éƒ¨æ·»åŠ ç§æœ‰è¾…åŠ©æ–¹æ³•
- å¦‚`createExecutionContext()`ã€`mapBasicProps()`ç­‰
- ç®€åŒ–`toEntity()`å’Œ`toModel()`æ–¹æ³•

**æ•ˆæœ**ï¼š
- æé«˜ä»£ç å¯è¯»æ€§
- ä¾¿äºæµ‹è¯•
- é™ä½å¤æ‚åº¦

### 3.4 æŸ¥è¯¢é€»è¾‘ä¼˜åŒ–

#### å»ºè®®1ï¼šç»Ÿä¸€ä½¿ç”¨QueryOptionsBuilder

**æ–¹å‘**ï¼š
- åœ¨BaseRepositoryä¸­ç»Ÿä¸€ä½¿ç”¨QueryOptionsBuilder
- é¿å…ç›´æ¥ä½¿ç”¨QueryBuilder
- æä¾›ä¸€è‡´çš„æŸ¥è¯¢æ„å»ºæ–¹å¼

**æ•ˆæœ**ï¼š
- ä»£ç é£æ ¼ç»Ÿä¸€
- æé«˜å¯ç»´æŠ¤æ€§
- é™ä½å­¦ä¹ æˆæœ¬

#### å»ºè®®2ï¼šåœ¨BaseRepositoryä¸­é…ç½®é»˜è®¤æŸ¥è¯¢æ¡ä»¶

**æ–¹å‘**ï¼š
- åœ¨BaseRepositoryä¸­æ·»åŠ é»˜è®¤è¿‡æ»¤æ¡ä»¶é…ç½®
- å¦‚é»˜è®¤æ’é™¤å·²åˆ é™¤è®°å½•
- å­ç±»å¯ä»¥è¦†ç›–é»˜è®¤é…ç½®

**æ•ˆæœ**ï¼š
- å‡å°‘é‡å¤ä»£ç 
- ç»Ÿä¸€æŸ¥è¯¢è¡Œä¸º
- æé«˜å¼€å‘æ•ˆç‡

### 3.5 é”™è¯¯å¤„ç†ä¼˜åŒ– âœ… å·²æœ‰åŸºç¡€

**ç°çŠ¶**ï¼š
- [`BaseRepository`](src/infrastructure/persistence/base/base-repository.ts:12) å·²å®šä¹‰äº†ç»Ÿä¸€çš„é”™è¯¯ç±»å‹ï¼š
  - `ErrorType` æšä¸¾ - é”™è¯¯ç±»å‹
  - `ErrorContext` æ¥å£ - é”™è¯¯ä¸Šä¸‹æ–‡
  - `EnhancedRepositoryError` ç±» - å¢å¼ºçš„é”™è¯¯ç±»
- å·²æä¾› `handleError()` å’Œ `safeExecute()` æ–¹æ³•ç»Ÿä¸€é”™è¯¯å¤„ç†

**å»ºè®®**ï¼š
- å­ç±»åº”ä½¿ç”¨ `safeExecute()` åŒ…è£…å¯èƒ½å‡ºé”™çš„æ“ä½œ
- ä½¿ç”¨ `handleError()` æŠ›å‡ºç»Ÿä¸€æ ¼å¼çš„é”™è¯¯
- åœ¨é”™è¯¯ä¸Šä¸‹æ–‡ä¸­æä¾›ä¸°å¯Œçš„è°ƒè¯•ä¿¡æ¯

**æ•ˆæœ**ï¼š
- é”™è¯¯å¤„ç†ç»Ÿä¸€
- ä¾¿äºé”™è¯¯æ•è·å’Œå¤„ç†
- æ”¹å–„è°ƒè¯•ä½“éªŒ

## å››ã€ä¼˜åŒ–ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ä¼˜åŒ–é¡¹ | å½±å“ | å·¥ä½œé‡ | çŠ¶æ€ |
|-------|-------|------|--------|------|
| ğŸ”´ é«˜ | å¼•å…¥æŸ¥è¯¢å¯¹è±¡æ¨¡å¼ | å¤§ | ä¸­ | å¾…å®æ–½ |
| ğŸ”´ é«˜ | åœ¨BaseRepositoryä¸­æå–å…¬å…±æŸ¥è¯¢é€»è¾‘ | å¤§ | ä¸­ | âœ… å·²å®Œæˆ |
| ğŸ”´ é«˜ | åœ¨BaseRepositoryä¸­ç»Ÿä¸€é”™è¯¯å¤„ç† | ä¸­ | ä½ | âœ… å·²æœ‰åŸºç¡€ |
| ğŸŸ¡ ä¸­ | æ‹†åˆ†é•¿æ–¹æ³• | ä¸­ | ä¸­ | å¾…å®æ–½ |
| ğŸŸ¡ ä¸­ | åœ¨type-converter-base.tsä¸­æ·»åŠ è½¬æ¢å™¨å·¥å‚ | ä¸­ | ä½ | âœ… å·²å®Œæˆ |
| ğŸŸ¡ ä¸­ | ç§»é™¤é‡å¤æ–¹æ³• | ä¸­ | ä½ | å¾…å®æ–½ |
| ğŸŸ¢ ä½ | æ˜ç¡®å®šä¹‰è¿”å›ç±»å‹ | å° | ä½ | å¾…å®æ–½ |
| ğŸŸ¢ ä½ | ç§»é™¤æœªä½¿ç”¨æ–¹æ³• | å° | ä½ | å¾…å®æ–½ |

## äº”ã€æ¶æ„ä¾èµ–å…³ç³»

```
Application Layer
    â†“ ä¾èµ–
Domain Layer Repositories (æ¥å£å®šä¹‰)
    â†‘ å®ç°
Infrastructure Layer (å…·ä½“å®ç°)
    â†“ ä½¿ç”¨
Domain Entities & Value Objects
```

**å…³é”®åŸåˆ™**ï¼š
- Domainå±‚ä¸ä¾èµ–ä»»ä½•å…¶ä»–å±‚
- Infrastructureå±‚åªä¾èµ–Domainå±‚
- Applicationå±‚åªä¾èµ–Domainå±‚
- Interfaceå±‚åªä¾èµ–Applicationå±‚

## å…­ã€ç›¸å…³æ–‡ä»¶

### Domainå±‚æ¥å£
- `src/domain/common/repositories/repository.ts` - åŸºç¡€Repositoryæ¥å£
- `src/domain/checkpoint/repositories/checkpoint-repository.ts`
- `src/domain/sessions/repositories/session-repository.ts`
- `src/domain/workflow/repositories/workflow-repository.ts`
- `src/domain/threads/repositories/thread-repository.ts`

### Infrastructureå±‚å®ç°
- `src/infrastructure/persistence/base/base-repository.ts` - BaseRepositoryåŸºç±»
- `src/infrastructure/persistence/base/type-converter-base.ts` - ç±»å‹è½¬æ¢å™¨
- `src/infrastructure/persistence/repositories/checkpoint-repository.ts`
- `src/infrastructure/persistence/repositories/session-repository.ts`
- `src/infrastructure/persistence/repositories/workflow-repository.ts`
- `src/infrastructure/persistence/repositories/thread-repository.ts`

### Applicationå±‚ä½¿ç”¨
- `src/application/threads/services/thread-service.ts`
- `src/application/container/bindings/application-bindings.ts`